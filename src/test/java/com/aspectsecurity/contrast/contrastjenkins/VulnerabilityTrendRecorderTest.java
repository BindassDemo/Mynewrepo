package com.aspectsecurity.contrast.contrastjenkins;

import hudson.util.FormValidation;
import junit.framework.TestCase;
import org.junit.Before;
import org.junit.Test;

public class VulnerabilityTrendRecorderTest extends TestCase {

    private VulnerabilityTrendRecorder.DescriptorImpl descriptor;

    @Before
    @Override
    public void setUp() {
        descriptor = new VulnerabilityTrendRecorderStub.DescriptorImplStub();
    }

    @Test
    public void testDoThresholdSeverityValid() {
        FormValidation result = descriptor.doCheckThresholdSeverity("high");
        assertEquals(result.kind, FormValidation.Kind.OK);
    }

    @Test
    public void testDoThresholdSeverityInvalid() {
        FormValidation result = descriptor.doCheckThresholdSeverity("");
        // not required
        assertEquals(result.kind, FormValidation.Kind.OK);
    }

    @Test
    public void testDoThresholdCountValid() {
        FormValidation result = descriptor.doCheckThresholdCount("10");
        assertEquals(result.kind, FormValidation.Kind.OK);
    }

    @Test
    public void testDoThresholdCountInvalid() {
        FormValidation result = descriptor.doCheckThresholdCount("-1");
        assertEquals(result.kind, FormValidation.Kind.ERROR);

        result = descriptor.doCheckThresholdCount("not_an_integer");
        assertEquals(result.kind, FormValidation.Kind.ERROR);
    }
}