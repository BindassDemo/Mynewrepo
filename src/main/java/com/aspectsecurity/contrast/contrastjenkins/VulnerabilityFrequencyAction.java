package com.aspectsecurity.contrast.contrastjenkins;

import com.aspectsecurity.contrast.contrastjenkins.plots.VulnerabilityFrequencyPlot;
import hudson.model.AbstractBuild;
import hudson.model.Action;
import hudson.util.Graph;

public class VulnerabilityFrequencyAction implements Action {

    private AbstractBuild<?, ?> build;
    private VulnerabilityTrendResult result;

    public VulnerabilityFrequencyAction(VulnerabilityTrendResult result, AbstractBuild<?, ?> build) {
        this.result = result;
        this.build = build;
    }

    public String getIconFileName() {
        return "/plugin/contrast-jenkins/img/trend_graph.png";
    }

    public String getDisplayName() {
        return "Vulnerability Frequency Plot";
    }

    public String getUrlName() {
        return "vulnFreqPlot";
    }

    public int getBuildNumber() {
        return this.build.number;
    }

    public AbstractBuild<?, ?> getBuild() {
        return build;
    }

    public Graph getGraph() {
        return new VulnerabilityFrequencyPlot(build);
    }

    public VulnerabilityTrendResult getResult() {
        return result;
    }

    @Override
    public String toString() {
        return "Build Number #" + getBuildNumber() + "\nResults: " + result.toString();
    }
}